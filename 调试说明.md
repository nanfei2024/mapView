# 知识图谱页面调试说明

## 问题描述
完整页面（/hierarchical-graph）显示空白，返回按钮无效。

## 已修复的问题

### 1. 返回按钮修复
```typescript
const goBack = () => {
  // 优先返回文件管理中心，如果没有历史记录则返回首页
  if (window.history.length > 1) {
    router.back();
  } else {
    router.push('/file-list');
  }
};
```

### 2. 画布高度修复
```css
.canvas {
  width: 100%;
  height: 100%;
  min-height: 600px; /* 添加最小高度 */
}
```

### 3. 延迟初始化
```typescript
onMounted(() => {
  // 延迟100ms初始化，确保DOM完全渲染
  setTimeout(() => {
    if (chartContainer.value) {
      console.log('初始化图谱，容器尺寸:', {
        width: chartContainer.value.offsetWidth,
        height: chartContainer.value.offsetHeight
      });
      initGraph();
    }
  }, 100);
});
```

## 调试步骤

### 1. 打开浏览器控制台
按 F12 打开开发者工具，切换到 Console 标签

### 2. 访问页面
访问 `http://localhost:5173/hierarchical-graph`

### 3. 查看控制台输出
应该看到以下日志：
```
初始化图谱，容器尺寸: { width: xxx, height: xxx }
开始初始化 ECharts
ECharts 初始化完成，开始构建图谱
图谱构建完成
```

### 4. 检查容器尺寸
如果容器尺寸为 0 或很小，说明 CSS 有问题

### 5. 检查 ECharts 错误
如果有 ECharts 相关错误，检查是否正确导入

## 常见问题排查

### 问题1：页面完全空白
**可能原因：**
- Vue 组件渲染失败
- 路由配置错误
- 编译错误

**排查方法：**
1. 检查浏览器控制台是否有错误
2. 检查 Network 标签，确认 JS 文件加载成功
3. 检查 Vue DevTools

### 问题2：有顶部栏但图谱区域空白
**可能原因：**
- 容器高度为 0
- ECharts 初始化失败
- 数据为空

**排查方法：**
1. 检查控制台日志中的容器尺寸
2. 使用浏览器检查元素，查看 `.canvas` 的实际高度
3. 检查是否有 ECharts 错误

### 问题3：返回按钮无反应
**可能原因：**
- 没有历史记录且路由跳转失败
- 事件未绑定

**排查方法：**
1. 检查控制台是否有路由错误
2. 点击按钮时查看 Network 标签
3. 确认 router 对象存在

## 手动测试步骤

### 测试1：直接访问
```
访问: http://localhost:5173/hierarchical-graph
预期: 显示图谱，有3个书籍节点
```

### 测试2：从文件管理中心跳转
```
1. 访问: http://localhost:5173/file-list
2. 点击"知识图谱"标签
3. 点击"完整页面"按钮
预期: 跳转到完整页面并显示图谱
```

### 测试3：返回按钮
```
1. 在完整页面点击"返回"按钮
预期: 返回到文件管理中心
```

## 临时解决方案

如果问题持续，可以尝试：

### 方案1：强制刷新
```bash
# 清除缓存并重新构建
npm run build
# 或者
Ctrl + F5 强制刷新浏览器
```

### 方案2：检查依赖
```bash
# 重新安装依赖
rm -rf node_modules
npm install
```

### 方案3：使用开发模式
```bash
npm run dev
```
然后访问显示的本地地址

## 需要检查的文件

1. `src/views/HierarchicalGraphPage.vue` - 主页面组件
2. `src/router/index.ts` - 路由配置
3. `package.json` - 依赖版本

## 预期的控制台输出

### 正常情况
```
初始化图谱，容器尺寸: { width: 1200, height: 800 }
开始初始化 ECharts
ECharts 初始化完成，开始构建图谱
图谱构建完成
```

### 异常情况
```
图谱容器不存在
// 或
初始化图谱，容器尺寸: { width: 0, height: 0 }
```

## 下一步

如果以上方法都无效，请提供：
1. 浏览器控制台的完整错误信息
2. Network 标签中的请求列表
3. 浏览器版本信息
