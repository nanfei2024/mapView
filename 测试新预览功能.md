# 🧪 测试新预览功能 - 快速指南

## 🚀 第一步：重启服务器

### 停止当前服务器
在运行 `npm run dev` 的终端窗口按 `Ctrl + C`

### 重新启动
```powershell
npm run dev
```

⚠️ **重要**：必须重启才能加载新的路由！

---

## 🎯 第二步：测试预览功能

### 1. 打开浏览器
访问：`http://localhost:5173`

### 2. 进入文档数字化
点击主页的 **"地质文档数字化"** 按钮

### 3. 解析一个文档

**方式 A：使用 URL 上传（推荐）**
```
示例 URL：
https://your-file-url/document.pdf
```

**或使用之前已解析的文档**（如果列表中有的话）

### 4. 点击"预览结果" 🎯

当文档解析完成（状态显示"已完成"），点击：
- **"预览结果"** 按钮（蓝色）

→ 应该会**跳转到新页面**！

---

## ✅ 预期效果

### 新预览页面应该显示：

```
┌───────────────────────────────────────────────────────┐
│  [← 返回]  文件名.pdf  [下载完整结果] [切换布局]     │
├───────────────────────────────────────────────────────┤
│  ┌─────────────────────┬───────────────────────────┐  │
│  │ 📄 源文件            │ 📝 解析结果               │  │
│  │ PDF 文档            │ [渲染视图] [源码视图]     │  │
│  ├─────────────────────┼───────────────────────────┤  │
│  │                     │                           │  │
│  │  [PDF显示区域]       │  # 标题                   │  │
│  │                     │  正文内容...              │  │
│  │  原始文档           │  - 列表                   │  │
│  │                     │  - 列表                   │  │
│  │                     │                           │  │
│  └─────────────────────┴───────────────────────────┘  │
└───────────────────────────────────────────────────────┘
```

### 功能测试：

✅ **左侧**：显示 PDF（如果有源文件URL）  
✅ **右侧**：显示渲染后的 Markdown  
✅ **切换视图**：点击"源码视图"查看原始 Markdown  
✅ **切换布局**：点击"纵向对比"改为上下布局  
✅ **下载**：点击"下载完整结果"  
✅ **返回**：点击"← 返回"回到文档数字化页面  

---

## 🐛 如果遇到问题

### 问题 1：点击"预览结果"没有跳转

**检查：**
1. 浏览器控制台（F12）有没有错误？
2. 服务器是否重启了？

**解决：**
```powershell
# 停止服务器 (Ctrl + C)
# 重新启动
npm run dev
```

### 问题 2：预览页面显示"正在加载"一直不动

**检查：**
1. 代理服务器是否运行？
   - 访问：`http://localhost:3001/health`
   - 应该看到：`{"status":"ok",...}`

2. 如果代理服务器没运行：
```powershell
# 新终端窗口
cd mapView-main
npm run proxy
```

### 问题 3：左侧 PDF 显示错误

**原因：** PDF URL 可能有跨域限制

**影响：** 不影响右侧 Markdown 预览

**建议：** 忽略左侧错误，专注查看右侧解析结果

---

## 📊 对比旧版预览

| 功能 | 旧版（弹窗） | 新版（独立页面） |
|------|------------|-----------------|
| 显示方式 | 小弹窗 | 全屏页面 ✨ |
| PDF 预览 | ❌ | ✅ 左侧显示 |
| 对比查看 | ❌ | ✅ 左右对比 |
| 视图切换 | ❌ | ✅ 渲染/源码 |
| 布局调整 | ❌ | ✅ 横向/纵向 |

---

## 🎯 快速测试流程

```bash
# 1. 重启服务器
Ctrl + C (停止)
npm run dev (启动)

# 2. 打开浏览器
http://localhost:5173

# 3. 导航
点击 "地质文档数字化"

# 4. 解析
输入 URL → 开始解析 → 等待完成

# 5. 预览
点击 "预览结果" → 查看对比界面 ✨

# 6. 测试功能
- 左右滚动查看
- 切换视图模式
- 切换布局方向
- 下载结果
- 返回主页
```

---

## 📸 预期界面特征

### 顶部导航栏
- ✅ 左上角有"← 返回"按钮
- ✅ 中间显示文件名
- ✅ 右侧有"下载完整结果"和"切换布局"按钮

### 左侧面板
- ✅ 标题：📄 源文件
- ✅ 副标题：PDF 文档
- ✅ 内容区：PDF 显示或错误提示

### 右侧面板
- ✅ 标题：📝 解析结果
- ✅ 视图切换按钮：[渲染视图] [源码视图]
- ✅ 内容区：美观的 Markdown HTML 渲染

---

## 💡 提示

### 最佳体验：

1. **使用 URL 上传**：避免本地文件跨域问题
2. **保持代理运行**：确保能下载 ZIP 文件
3. **使用 Chrome/Edge**：最佳兼容性

### 测试文件建议：

- ✅ 中等大小的 PDF（10-50页）
- ✅ 包含文字、表格的文档
- ✅ 公开可访问的 URL

---

**现在去测试吧！** 🚀

如果一切正常，您应该看到一个专业的对比预览界面！


