# 📄 PDF 预览功能说明

## ✅ 问题已解决

您的问题已经完美解决！现在**预览页面左侧可以直接显示 PDF 源文件**，右侧显示解析后的 Markdown 结果。

---

## 🎯 新功能特性

### 1. **多种 PDF 预览方式**

在预览页面左上角，我为您提供了**3 种 PDF 查看方式**：

#### 📄 **PDF.js（推荐）** ✅
- 使用 Mozilla 官方的 PDF.js 查看器
- **功能最完整**：支持缩放、翻页、搜索、打印等
- 兼容性最好，支持所有 URL
- **默认选项**

#### 🌐 **Google Docs Viewer**
- 使用 Google 文档查看器
- 界面简洁，加载较快
- 适合简单预览

#### 🔗 **Direct（直接预览）**
- 浏览器内置 PDF 查看器
- 最简单，但功能有限
- 可能受 CORS 限制

#### ⬇️ **下载 PDF**
- 一键下载原始 PDF 文件
- 方便离线查看

---

## 🚀 使用方法

### 第一步：URL 上传
在**地质文档数字化**页面，通过 **URL 方式**上传您的 PDF 文件：

```
示例 URL：
https://raw.githubusercontent.com/your-repo/file.pdf
```

### 第二步：等待解析
系统会自动调用 MinerU API 解析文档，显示实时进度。

### 第三步：预览对比
解析完成后，点击 **"预览结果"** 按钮：

```
┌─────────────────────────────────────────────────────┐
│ [📄 PDF.js] [🌐 Google] [🔗 Direct] [⬇️ 下载]    │
├──────────────────┬──────────────────────────────────┤
│                  │                                  │
│  📄 源 PDF       │  📝 解析后的 Markdown           │
│  (左侧)          │  (右侧)                         │
│                  │                                  │
│  可缩放、翻页    │  [渲染视图] [源码视图]          │
│                  │                                  │
└──────────────────┴──────────────────────────────────┘
```

### 第四步：切换查看方式
如果默认的 **PDF.js** 加载有问题，可以点击顶部按钮切换到：
- 🌐 **Google** 查看器
- 🔗 **Direct** 直接预览

---

## 📌 重要提示

### ✅ 推荐使用 **URL 上传方式**

**为什么？**
1. **可以预览原文**：URL 上传时会保存源文件地址，预览页面可以直接显示
2. **避免 CORS 问题**：不需要通过阿里云 OSS 上传（OSS 有跨域限制）
3. **更加便捷**：一键提交，无需等待文件上传

**推荐的 URL 来源**：
- ✅ GitHub Releases
- ✅ GitHub raw 链接
- ✅ 公开的文件服务器
- ✅ 您自己的服务器

### ⚠️ 本地上传的限制

如果使用**本地文件上传**：
- ❌ **左侧无法预览**：浏览器安全策略限制，无法显示本地文件
- ✅ **右侧正常**：解析结果仍然可以正常查看
- 💡 **解决方案**：建议先将文件上传到 GitHub 等平台，然后使用 URL 上传

---

## 🎨 界面说明

### 左侧面板（源文件）
```
┌────────────────────────────────────┐
│ 📄 源文件     PDF 文档             │
├────────────────────────────────────┤
│ [📄 PDF.js] [🌐 Google] [🔗 Direct] [⬇️ 下载]  │
├────────────────────────────────────┤
│                                    │
│     📄 PDF 内容在这里显示           │
│                                    │
│     支持缩放、翻页、搜索           │
│                                    │
└────────────────────────────────────┘
```

### 右侧面板（解析结果）
```
┌────────────────────────────────────┐
│ 📝 解析结果  [渲染视图] [源码视图] │
├────────────────────────────────────┤
│                                    │
│  # 解析后的 Markdown 内容          │
│                                    │
│  ## 章节标题                       │
│  这是解析出来的文本内容...         │
│                                    │
│  支持滚动查看所有内容              │
│                                    │
└────────────────────────────────────┘
```

---

## 🔧 技术说明

### PDF.js 查看器的优势

**Mozilla PDF.js** 是一个开源的 PDF 渲染库，特点：

1. **完全基于 Web**：无需插件，纯 JavaScript 实现
2. **功能丰富**：
   - ✅ 缩放（Zoom in/out）
   - ✅ 翻页（Page navigation）
   - ✅ 搜索（Search）
   - ✅ 打印（Print）
   - ✅ 下载（Download）
3. **兼容性好**：支持所有现代浏览器
4. **跨域支持**：可以加载任何公开 URL 的 PDF

### 为什么选择 Mozilla 官方 CDN？

```javascript
https://mozilla.github.io/pdf.js/web/viewer.html?file={您的PDF_URL}
```

- ✅ 稳定可靠（Mozilla 官方托管）
- ✅ 永久免费
- ✅ 全球 CDN 加速
- ✅ 自动更新到最新版本

---

## 🆘 常见问题

### Q1: 左侧 PDF 显示空白怎么办？

**A**: 尝试以下方法：
1. 点击顶部的 **🌐 Google** 或 **🔗 Direct** 切换查看方式
2. 检查 PDF URL 是否可以直接在浏览器中打开
3. 确保 PDF 文件大小不要太大（建议 < 50MB）

### Q2: 为什么本地上传的文件左侧显示不出来？

**A**: 这是浏览器的**安全限制**：
- 浏览器不允许网页直接访问用户本地文件
- **解决方案**：使用 **URL 上传方式**

### Q3: PDF.js 加载很慢怎么办？

**A**: 
1. 检查网络连接（PDF.js 托管在 GitHub）
2. 尝试切换到 **🌐 Google** 查看器
3. 或者直接点击 **⬇️ 下载** 按钮，在本地查看

### Q4: 如何获取文件的直链 URL？

**A**: 参考 `如何获取文件直链URL.md` 文档，推荐方法：

**GitHub 方法**：
```bash
1. 创建 GitHub 仓库
2. 上传 PDF 文件
3. 在文件页面点击 "View raw"
4. 复制浏览器地址栏的 URL
   例如：https://raw.githubusercontent.com/用户名/仓库名/main/文件.pdf
```

---

## 📊 对比表格

| 功能 | PDF.js | Google | Direct | 本地上传 |
|------|--------|--------|--------|----------|
| 预览源文件 | ✅ | ✅ | ✅ | ❌ |
| 缩放功能 | ✅ | ✅ | ⚠️ | - |
| 翻页功能 | ✅ | ✅ | ✅ | - |
| 搜索功能 | ✅ | ❌ | ⚠️ | - |
| 跨域支持 | ✅ | ✅ | ⚠️ | - |
| 加载速度 | 中 | 快 | 快 | - |
| 推荐程度 | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐ | ⭐⭐⭐ | ⭐ |

---

## 🎉 现在就试试吧！

1. 访问 **地质文档数字化** 页面
2. 使用 **URL 上传** 一个 PDF 文件
3. 等待解析完成
4. 点击 **预览结果**
5. 享受**左右对比**的完美体验！

---

## 📝 更新日志

**2025-11-09**
- ✅ 新增多种 PDF 预览方式（PDF.js, Google, Direct）
- ✅ 默认使用 Mozilla PDF.js 查看器
- ✅ 新增预览方式切换按钮
- ✅ 新增 PDF 下载按钮
- ✅ 优化预览界面布局
- ✅ 完善错误提示信息

---

**祝您使用愉快！** 🎊

